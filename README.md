# openwsn-data: objective

This repository helps to analyse the data produced by openwsn-fw (https://github.com/ftheoleyre/openwsn-fw/tree/CCA) and openvisualizer (https://github.com/ftheoleyre/openvisualizer).



# Preprocessing

First you have to prepare the sqlite db files produced by openvisualizer with the following command:

`python3 convert_db_in_json.py --dir XXX`

XXX is the directory that contains the experiment (one experiment per subdirectory, whatever the name is).

It works as following

1. it merges all the sqlite individual databases in a single one `openv_events.db`
1. it processes all the layer 2 transmissions (per link) to identify CCA, SFD, hidden receivers, etc.
1. it processes all the cexample packets (per cexample packet generated by a source). For each packet, it keeps a record of the actions all along the path (tx, asn, etc.)
1. for each experiment, it extracts all the metadata (nb of nodes, etc.)
1. everything is finally stored in a json file `stats.json`

By default, the script doesn't re-process the pre-processed directory (with an existing `stats.json` file). We can force the reprocessing with the option: `--rewrite`



# Fault Tolerance scenario

The directory MUST be pre-processed before extracting data.

`python plot_faultolerance.py --dir XXX`

The script extracts the delay of reception of each cexample packet for two scenarios (with and without CCA). Two different figures are plotted to represent the distribution of the delay according to the experiment time (when the fault happens, the delay shall increase, or the packets may event stop to be delivered).



# Scalability scenario

The script plots:

* the PDR, delay and number of layer 2 transmissions for each group of exepriments with the same number of nodes
* for each radio link the ratio of time the CCA is negative, how many start of frames interrupts are triggered, etc.
 
 
On stdout are also printed individual statistics (for debuging mainly):

* for each cexample source, the perf metrics (PDR, delay, etc.)
* fo each link, the ratio of positive CCA, SFD, etc.
